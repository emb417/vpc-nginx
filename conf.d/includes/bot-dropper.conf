# ----------------------------------------------------------------------
# Bot Dropper: silently drop common IoT/router exploit scans
# ----------------------------------------------------------------------

# ASUS / router / IoT exploit probes (path-based)
location ~* /(login\.cgi|Main_Login\.asp|appGet\.cgi|start_apply\.cgi|apply\.cgi|Advanced_.*\.asp)(\?|$) {
    return 444;
}

# Unified extension-based dropper for generic exploit probes
location ~* \.(cgi|asp|cfg|ini|bak|backup|old|env)(\?|$) {
    return 444;
}

# WordPress / Joomla / PHP exploit scans
location ~* \.(php|php5|php7|phtml)(\?|$) {
    return 444;
}

# Common bot paths that should never hit the app
location ~* /(wp-admin|wp-login|wp-content|xmlrpc\.php|phpmyadmin|pma|hudson|jenkins|shell|console) {
    return 444;
}

# Block requests with empty or missing Host header (botnet signature)
if ($host = "") {
    return 444;
}

# Block requests directly to IP instead of domain
if ($host ~* "^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$") {
    return 444;
}

# Block obvious scanner user-agents
if ($http_user_agent ~* "(asusrouter|curl|wget|python-requests|masscan|nmap|sqlmap)") {
    return 444;
}
